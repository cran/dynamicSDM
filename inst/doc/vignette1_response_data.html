<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>dynamicSDM: Response variable data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">dynamicSDM: Response variable data</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><em>dynamicSDM</em> offers novel tools for developing species
geographical distribution and abundance modelling (SDM) at high
spatiotemporal resolution. Across the dynamicSDM vignettes, we
demonstrate package functions on a case study species and guide users
through the four key species distribution modelling stages:</p>
<ul>
<li>Stage 1: Organising response variable data including species
occurrence and pseudo-absence records</li>
<li>Stage 2: Extracting spatio-temporally buffered explanatory
variables</li>
<li>Stage 3: Fitting SDMs whilst accounting for spatial and temporal
autocorrelation</li>
<li>Stage 4: Projecting intra- and inter-annual geographical
distributions and abundances at high spatiotemporal resolution.</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Before starting this tutorial, the <em>dynamicSDM</em> package needs
to be installed. You can install the latest version from <a href="https://github.com/r-a-dobson/dynamicSDM">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&#39;r-a-dobson/dynamicSDM&#39;)</span></span></code></pre></div>
<p>or from <a href="https://CRAN.R-project.org/package=dynamicSDM">CRAN</a> with</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;dynamicSDM&quot;)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dynamicSDM)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; terra 1.7.3</span></span></code></pre></div>
<p>Due to the utilisation of Google Earth Engine and Google Drive across
<em>dynamicSDM</em> functions, you must also set up a free Google
account at <a href="https://www.google.com/account/about/">Google</a>.
Once you have your Google log-in details, these can be used to authorise
Google Earth Engine in the <code>rgee</code> package and Google Drive in
the <code>googledrive</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgee)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rgee::ee_install()</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>rgee<span class="sc">::</span><span class="fu">ee_check</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googledrive)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#googledrive::drive_auth_configure()</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>googledrive<span class="sc">::</span><span class="fu">drive_user</span>()</span></code></pre></div>
</div>
<div id="directory-organisation" class="section level2">
<h2>Directory organisation</h2>
<p>As we continue through the species distribution modelling framework,
functions will generate a range of outputs. To keep organised, we
recommend a structured directory system. The code below will create a
new project directory in your temporary folders, but you can edit the
script to specify your home directory if you want to retain function
outputs between R sessions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>project_directory <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;dynamicSDM_vignette&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(project_directory)</span></code></pre></div>
</div>
<div id="case-study-the-red-billed-quelea" class="section level2">
<h2>Case study: the red-billed quelea</h2>
<p>In this four stage tutorial, we will be studying the case study
species, the red-billed quelea (Quelea quelea), a nomadic bird
inhabiting sub-Saharan Africa. With highly variable distributions driven
by short-term weather and resource availability, <em>dynamicSDM</em>
provides key functions to accurately model quelea’s distribution through
space and time.</p>
</div>
<div id="stage-1-response-variable-data" class="section level2">
<h2>Stage 1: Response variable data</h2>
<p>In this tutorial, we will be processing a sample of species
occurrence records for the red-billed quelea (Quelea quelea) to generate
an SDM response variable data frame. This will involve filtering records
by spatio-temporal quality, extent and resolution; testing and
accounting for spatio-temporal biases in records, and generating
pseudo-absences through space and time.</p>
<div id="a-import-occurrence-records" class="section level3">
<h3>a) Import occurrence records</h3>
<p>A sample of red-billed quelea occurrence data can be loaded into your
local R environment using the code below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;sample_occ_data&quot;</span>)</span></code></pre></div>
<p>These records are formatted as exported from the Global Biodiversity
Information Facility, with columns labelled “decimalLongitude” and
“decimalLatitude”. For <em>dynamicSDM</em> functions, occurrence data
must be in a specific format; containing numeric data in columns
labelled “x” and “y” for the record co-ordinates longitude and latitude,
and “day”, “month” and “year” for the record’s date.</p>
<p><code>convert_gbif()</code> can be used to convert between these
formats, or this can be achieved manually for data not extracted from
GBIF.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sample_occ <span class="ot">&lt;-</span> <span class="fu">convert_gbif</span>(sample_occ_data)</span></code></pre></div>
</div>
<div id="b-filter-occurrence-records" class="section level3">
<h3>b) Filter occurrence records</h3>
<div id="validity-and-completeness" class="section level4">
<h4>Validity and completeness</h4>
<p>Species occurrence records may contain anomalous or missing values in
the co-ordinates or dates given. <code>spatiotemp_check()</code> can be
used to exclude records with missing (NA) values (argument
<code>na.handle</code>), invalid co-ordinates
(<code>coord.handle</code>), invalid dates (<code>date.handle</code>)
and duplicate records (<code>duplicate.handle</code>).</p>
<p>Here, we specify <code>date.res = &quot;day&quot;</code> to check all date
columns from year to day. If you only want to check the year of record
dates, then you could specify <code>date.res = &quot;year&quot;</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sample_occ_filtered <span class="ot">&lt;-</span> <span class="fu">spatiotemp_check</span>(<span class="at">occ.data =</span> sample_occ,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">na.handle =</span> <span class="st">&quot;exclude&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">date.handle =</span> <span class="st">&quot;exclude&quot;</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">date.res =</span> <span class="st">&quot;day&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">coord.handle =</span> <span class="st">&quot;exclude&quot;</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">duplicate.handle =</span> <span class="st">&quot;exclude&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; omitting any species records with coordinates containing NA</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; omitting any species records with dates containing NA</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; omitting any duplicate records</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; any records with invalid co-ordinates excluded</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; any records with invalid dates excluded</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_occ_filtered)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 311</span></span></code></pre></div>
<p>Additionally, users can opt to take advantage of the
<code>CoordinateCleaner</code> package functions to exclude records
flagged as containing potentially anomalous co-ordinates, based on a
wider variety of spatial tests than <em>dynamicSDM</em> alone
offers.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sample_occ_filtered <span class="ot">&lt;-</span> <span class="fu">spatiotemp_check</span>(<span class="at">occ.data =</span> sample_occ,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">na.handle =</span> <span class="st">&quot;exclude&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">date.handle =</span> <span class="st">&quot;exclude&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">date.res =</span> <span class="st">&quot;day&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">coord.handle =</span> <span class="st">&quot;exclude&quot;</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">duplicate.handle =</span> <span class="st">&quot;exclude&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">coordclean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">coordclean.species =</span> <span class="st">&quot;quelea&quot;</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">coordclean.handle =</span> <span class="st">&quot;exclude&quot;</span>)</span></code></pre></div>
</div>
<div id="spatiotemporal-extent" class="section level4">
<h4>Spatiotemporal extent</h4>
<p>When generating dynamic species distribution models, it is important
that occurrence records match the spatio-temporal extent of the study
and any remote-sensing datasets to be utilised as explanatory variables.
<code>spatiotemporal_extent()</code> removes any records outside of the
set extents.</p>
<p>In this case study, we want to model the subspecies Q. q. lathamii
which is typically limited to southern Africa and we will incorporate
remote sensing datasets available for the years 2001 to 2019. To filter
records to these extents, we use a polygon of southern African
countries, which can be read into your R environment and applied using
the following code.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;sample_extent_data&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sample_occ_cropped <span class="ot">&lt;-</span> <span class="fu">spatiotemp_extent</span>(<span class="at">occ.data =</span> sample_occ_filtered,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">temporal.ext =</span> <span class="fu">c</span>(<span class="st">&quot;2001-01-01&quot;</span>, <span class="st">&quot;2018-12-01&quot;</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">spatial.ext =</span> terra<span class="sc">::</span><span class="fu">ext</span>(sample_extent_data),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; spatial.ext could not be used as a mask.</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Lets plot the change</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#terra::plot(sample_extent_data$geometry)</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(sample_occ_filtered[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#terra::plot(sample_extent_data$geometry)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(sample_occ_cropped[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="spatiotemporal-resolution" class="section level4">
<h4>Spatiotemporal resolution</h4>
<p>The spatial resolution of occurrence record co-ordinates and the
temporal resolution of occurrence record dates are also important when
generating dynamic SDMs. <code>spatiotemp_resolution()</code> can filter
records by set thresholds.</p>
<p>As quelea migrations are driven by highly local and short-term
environmental factors, we will filter to exclude records not given to
the specific day and co-ordinates to four decimal places.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sample_occ_cropped<span class="ot">&lt;-</span><span class="fu">spatiotemp_resolution</span>(<span class="at">occ.data =</span> sample_occ_cropped,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">spatial.res =</span> <span class="dv">4</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">temporal.res =</span> <span class="st">&quot;day&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_occ_cropped) <span class="co"># Even more records have been removed!</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 142</span></span></code></pre></div>
</div>
</div>
<div id="c-test-for-spatial-and-temporal-sampling-biases" class="section level3">
<h3>c) Test for spatial and temporal sampling biases</h3>
<p>For many reasons, the collection of species occurrence records are
biased through space and time. These biases can impact SDM performance
by over- or under- representing conditions at a given site or time.
<code>spatiotemp_bias()</code> returns the results of statistical tests
and plots for visual assessment of such biases. The code below tests for
bias across the entire dataset and species range.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bias_results <span class="ot">&lt;-</span> <span class="fu">spatiotemp_bias</span>(<span class="at">occ.data =</span> sample_occ_cropped,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">temporal.level =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">spatial.method =</span> <span class="st">&quot;simple&quot;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>bias_results</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Temporal_bias_year</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Chi-squared test for given probabilities</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  occ.data.frequency</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 50.451, df = 15, p-value = 1.016e-05</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Spatial_bias</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  min.nndist.actual and min.nndist.random</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -7.077, df = 246.15, p-value = 1.528e-11</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -72542.48 -40954.54</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x mean of y </span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  45486.12 102234.63</span></span></code></pre></div>
<p>Whereas, this code will test for bias across only the core of the
species range.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bias_results <span class="ot">&lt;-</span> <span class="fu">spatiotemp_bias</span>(<span class="at">occ.data =</span> sample_occ_cropped,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">temporal.level =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">spatial.method =</span> <span class="st">&quot;core&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>bias_results</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Temporal_bias_year</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Chi-squared test for given probabilities</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  occ.data.frequency</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 50.451, df = 15, p-value = 1.016e-05</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Spatial_bias</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  min.nndist.actual and min.nndist.random</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -0.29822, df = 187.91, p-value = 0.7659</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -16521.76  12182.37</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x mean of y </span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  45486.12  47655.82</span></span></code></pre></div>
<p>Both approaches can generate important results. The latter may be a
more reliable indicator if the species range is expanding or shifting in
response to global change. This is because records at the range
periphery that have been collected randomly may still not be evenly
distributed through space and time due to underlying ecological
processes. Therefore, testing for biases on the species range core may
be more representative of true spatial and temporal sampling biases.</p>
</div>
<div id="d-account-for-spatial-and-temporal-sampling-biases" class="section level3">
<h3>d) Account for spatial and temporal sampling biases</h3>
<div id="occurrence-record-thinning" class="section level4">
<h4>Occurrence record thinning</h4>
<p>One approach to correct spatio-temporal sampling biases are to “thin”
records, which involves excluding records that have been collected too
closely in space or time. <code>spatiotemp_thin()</code> allows users to
specify the spatial and temporal distance to thin records by. An
important argument of <code>spatiotemp_thin()</code> is
<code>spatial.split.degrees</code> which specifies the size of grid
cells to split occurrence records into before temporal thinning. This
prevents spatially distant but temporally close records from being
filtered out.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>occ_thin <span class="ot">&lt;-</span> <span class="fu">spatiotemp_thin</span>(<span class="at">occ.data =</span> sample_occ_cropped,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">temporal.method =</span> <span class="st">&quot;day&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">temporal.dist =</span> <span class="dv">30</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">spatial.split.degrees =</span> <span class="dv">3</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">spatial.dist =</span> <span class="dv">100000</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">iterations =</span> <span class="dv">5</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ********************************************** </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Beginning Spatial Thinning.</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Script Started at: Wed Jun 21 14:06:42 2023</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat.long.thin.count</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47 </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 47&quot;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ********************************************** </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Beginning Spatial Thinning.</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Script Started at: Wed Jun 21 14:06:43 2023</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat.long.thin.count</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 49 </span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 49&quot;</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ********************************************** </span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Beginning Spatial Thinning.</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Script Started at: Wed Jun 21 14:06:43 2023</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat.long.thin.count</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47 </span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 </span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 47&quot;</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ********************************************** </span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Beginning Spatial Thinning.</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Script Started at: Wed Jun 21 14:06:44 2023</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat.long.thin.count</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47 </span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 </span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 47&quot;</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ********************************************** </span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Beginning Spatial Thinning.</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Script Started at: Wed Jun 21 14:06:44 2023</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lat.long.thin.count</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48 </span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 </span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 48&quot;</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the difference in spatial distribution after thinning</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-thinned</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(sample_extent_data<span class="sc">$</span>geometry)</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(sample_occ_cropped[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Thinned</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(sample_extent_data<span class="sc">$</span>geometry)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(occ_thin[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="weight-records-by-sampling-effort" class="section level4">
<h4>Weight records by sampling effort</h4>
<p>Another approach to account for spatio-temporal sampling biases is to
weight records by sampling effort when fitting SDMs.This results in the
downweighting of the importance of records from over-sampled regions and
vice versa.</p>
<p>Here, we will read in a sample of e-Bird avian sampling records in
southern Africa to use as a proxy for sampling effort, and sum these
across a spatial and temporal buffer from each occurrence record using
<code>spatiotemp_weights()</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;sample_events_data&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sample_occ_cropped <span class="ot">&lt;-</span> <span class="fu">spatiotemp_weights</span>(<span class="at">occ.data =</span> sample_occ_cropped,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">samp.events =</span> sample_events_data,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">spatial.dist =</span> <span class="dv">100000</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">temporal.dist =</span> <span class="dv">30</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Records completed: 100</span></span></code></pre></div>
</div>
</div>
<div id="e-generate-pseudo-absences-through-space-and-time" class="section level3">
<h3>e) Generate pseudo-absences through space and time</h3>
<p>Often the paucity of species absence records necessitates the
generation of pseudo-absences, which are inferred absences based upon
presence records. When modelling a species distribution at high
spatiotemporal resolution, it may be best to generate pseudo-absences
within close spatial and temporal buffers of species occurrence. This is
because model presence-absence comparisons are made at fine scales,
instead of coarsely between biomes and seasons. Using
<code>spatiotemp_pseudoabs()</code> you can specify the spatial and
temporal buffer size or extents to randomly generate pseudo-absences
within.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pseudo-absences generated within spatial and temporal buffer</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pseudo_abs_buff <span class="ot">&lt;-</span> <span class="fu">spatiotemp_pseudoabs</span>(<span class="at">occ.data =</span> sample_occ_cropped,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">spatial.method =</span> <span class="st">&quot;buffer&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">temporal.method =</span> <span class="st">&quot;buffer&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">spatial.ext =</span> sample_extent_data,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">spatial.buffer =</span> <span class="fu">c</span>(<span class="dv">250000</span>, <span class="dv">500000</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">temporal.buffer =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">84</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">n.pseudoabs =</span> <span class="fu">nrow</span>(sample_occ_cropped))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pseudo-absences generated randomly across given spatial and temporal extent</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>pseudo_abs_rand <span class="ot">&lt;-</span> <span class="fu">spatiotemp_pseudoabs</span>(<span class="at">occ.data =</span> sample_occ_cropped,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">spatial.method =</span> <span class="st">&quot;random&quot;</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">temporal.method =</span> <span class="st">&quot;random&quot;</span>,  </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">spatial.ext =</span> sample_extent_data,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">temporal.ext =</span> <span class="fu">c</span>(<span class="st">&quot;2002-01-01&quot;</span>, <span class="st">&quot;2019-12-01&quot;</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">n.pseudoabs =</span> <span class="fu">nrow</span>(sample_occ_cropped))</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the spatial distribution of pseudo-absences (red) compared to occurrence records for:</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Buffered</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(sample_extent_data<span class="sc">$</span>geometry)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(sample_occ_cropped[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),<span class="at">col =</span> <span class="st">&quot;black&quot;</span>,<span class="at">add=</span>T)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(pseudo_abs_buff[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Random</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(sample_extent_data<span class="sc">$</span>geometry)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(sample_occ_cropped[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),<span class="at">col =</span> <span class="st">&quot;black&quot;</span>,<span class="at">add=</span>T)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(terra<span class="sc">::</span><span class="fu">vect</span>(pseudo_abs_rand[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then, the generated pseudo-absences need to be added to the
occurrence record data frame by adding relevant columns and binding the
rows together.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pseudo_abs_buff<span class="sc">$</span>decimalLatitude <span class="ot">&lt;-</span> pseudo_abs_buff<span class="sc">$</span>y</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>pseudo_abs_buff<span class="sc">$</span>decimalLongitude <span class="ot">&lt;-</span> pseudo_abs_buff<span class="sc">$</span>x</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>pseudo_abs_buff<span class="sc">$</span>occurrenceStatus <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;absent&quot;</span>, <span class="fu">nrow</span>(pseudo_abs_buff))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>pseudo_abs_buff<span class="sc">$</span>source <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;dynamicSDM&quot;</span>, <span class="fu">nrow</span>(pseudo_abs_buff))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>pseudo_abs_buff<span class="ot">&lt;-</span><span class="fu">spatiotemp_weights</span>(<span class="at">occ.data =</span> pseudo_abs_buff,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">samp.events =</span> sample_events_data,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">spatial.dist =</span> <span class="dv">100000</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">temporal.dist =</span> <span class="dv">30</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>complete.dataset <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(sample_occ_cropped, pseudo_abs_buff))</span></code></pre></div>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>At the end of this vignette, we now have a complete data frame of
filtered species occurrence and pseudo-absence records of appropriate
spatio-temporal quality, extent and resolution. Let’s save this to our
project directory for use in the next tutorial!</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(complete.dataset, <span class="at">file =</span> <span class="fu">paste0</span>(project_directory, <span class="st">&quot;/filtered_quelea_occ.csv&quot;</span>))</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
