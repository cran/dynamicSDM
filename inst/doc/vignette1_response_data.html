<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>dynamicSDM: Response variable data</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">dynamicSDM: Response variable data</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><em>dynamicSDM</em> offers novel tools for developing species geographical distribution and abundance modelling (SDM) at high spatiotemporal resolution. Across the dynamicSDM vignettes, we demonstrate package functions on a case study species and guide users through the four key species distribution modelling stages:</p>
<ul>
<li>Stage 1: Organising response variable data including species occurrence and pseudo-absence records</li>
<li>Stage 2: Extracting spatio-temporally buffered explanatory variables</li>
<li>Stage 3: Fitting SDMs whilst accounting for spatial and temporal autocorrelation</li>
<li>Stage 4: Projecting intra- and inter-annual geographical distributions and abundances at high spatiotemporal resolution.</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Before starting this tutorial, the <em>dynamicSDM</em> package needs to be installed. You can install the latest version from <a href="https://github.com/r-a-dobson/dynamicSDM">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># devtools::install_github(&#39;r-a-dobson/dynamicSDM&#39;)</span></a></code></pre></div>
<p>or from <a href="https://CRAN.R-project.org/package=dynamicSDM">CRAN</a> with</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co">#install.packages(&quot;dynamicSDM&quot;)</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">library</span>(dynamicSDM)</a></code></pre></div>
<p>Due to the utilisation of Google Earth Engine and Google Drive across <em>dynamicSDM</em> functions, you must also set up a free Google account at <a href="https://www.google.com/account/about/">Google</a>. Once you have your Google log-in details, these can be used to authorise Google Earth Engine in the <code>rgee</code> package and Google Drive in the <code>googledrive</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(rgee)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#rgee::ee_install()</span></a>
<a class="sourceLine" id="cb3-3" title="3">rgee<span class="op">::</span><span class="kw">ee_check</span>()</a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">library</span>(googledrive)</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#googledrive::drive_auth_configure()</span></a>
<a class="sourceLine" id="cb3-7" title="7">googledrive<span class="op">::</span><span class="kw">drive_user</span>()</a></code></pre></div>
<p>We will also use the package <code>sp</code> to visualise function output throughout the vignette. Install this package using the code below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co">#install.packages(&quot;sp&quot;)</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; Warning: package &#39;sp&#39; was built under R version 4.0.5</span></a></code></pre></div>
</div>
<div id="directory-organisation" class="section level2">
<h2>Directory organisation</h2>
<p>As we continue through the species distribution modelling framework, functions will generate a range of outputs. To keep organised, we recommend a structured directory system. The code below will create a new project directory in your temporary folders, but you can edit the script to specify your home directory if you want to retain function outputs between R sessions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">project_directory &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;dynamicSDM_vignette&quot;</span>))</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">dir.create</span>(project_directory)</a></code></pre></div>
</div>
<div id="case-study-the-red-billed-quelea" class="section level2">
<h2>Case study: the red-billed quelea</h2>
<p>In this four stage tutorial, we will be studying the case study species, the red-billed quelea (Quelea quelea), a nomadic bird inhabiting sub-Saharan Africa. With highly variable distributions driven by short-term weather and resource availability, <em>dynamicSDM</em> provides key functions to accurately model quelea’s distribution through space and time.</p>
</div>
<div id="stage-1-response-variable-data" class="section level2">
<h2>Stage 1: Response variable data</h2>
<p>In this tutorial, we will be processing a sample of species occurrence records for the red-billed quelea (Quelea quelea) to generate an SDM response variable data frame. This will involve filtering records by spatio-temporal quality, extent and resolution; testing and accounting for spatio-temporal biases in records, and generating pseudo-absences through space and time.</p>
<div id="a-import-occurrence-records" class="section level3">
<h3>a) Import occurrence records</h3>
<p>A sample of red-billed quelea occurrence data can be loaded into your local R environment using the code below.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">data</span>(<span class="st">&quot;sample_occ_data&quot;</span>)</a></code></pre></div>
<p>These records are formatted as exported from the Global Biodiversity Information Facility, with columns labelled “decimalLongitude” and “decimalLatitude”. For <em>dynamicSDM</em> functions, occurrence data must be in a specific format; containing numeric data in columns labelled “x” and “y” for the record co-ordinates longitude and latitude, and “day”, “month” and “year” for the record’s date.</p>
<p><code>convert_gbif()</code> can be used to convert between these formats, or this can be achieved manually for data not extracted from GBIF.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">sample_occ &lt;-<span class="st"> </span><span class="kw">convert_gbif</span>(sample_occ_data)</a></code></pre></div>
</div>
<div id="b-filter-occurrence-records" class="section level3">
<h3>b) Filter occurrence records</h3>
<div id="validity-and-completeness" class="section level4">
<h4>Validity and completeness</h4>
<p>Species occurrence records may contain anomalous or missing values in the co-ordinates or dates given. <code>spatiotemp_check()</code> can be used to exclude records with missing (NA) values (argument <code>na.handle</code>), invalid co-ordinates (<code>coord.handle</code>), invalid dates (<code>date.handle</code>) and duplicate records (<code>duplicate.handle</code>).</p>
<p>Here, we specify <code>date.res = &quot;day&quot;</code> to check all date columns from year to day. If you only want to check the year of record dates, then you could specify <code>date.res = &quot;year&quot;</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">sample_occ_filtered &lt;-<span class="st"> </span><span class="kw">spatiotemp_check</span>(<span class="dt">occ.data =</span> sample_occ,</a>
<a class="sourceLine" id="cb8-2" title="2">                                               <span class="dt">na.handle =</span> <span class="st">&quot;exclude&quot;</span>,</a>
<a class="sourceLine" id="cb8-3" title="3">                                               <span class="dt">date.handle =</span> <span class="st">&quot;exclude&quot;</span>,</a>
<a class="sourceLine" id="cb8-4" title="4">                                               <span class="dt">date.res =</span> <span class="st">&quot;day&quot;</span>,</a>
<a class="sourceLine" id="cb8-5" title="5">                                               <span class="dt">coord.handle =</span> <span class="st">&quot;exclude&quot;</span>,</a>
<a class="sourceLine" id="cb8-6" title="6">                                               <span class="dt">duplicate.handle =</span> <span class="st">&quot;exclude&quot;</span>)</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; omitting any species records with coordinates containing NA</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; omitting any species records with dates containing NA</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; omitting any duplicate records</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; any records with invalid co-ordinates excluded</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; any records with invalid dates excluded</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw">nrow</span>(sample_occ_filtered)</a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; [1] 311</span></a></code></pre></div>
<p>Additionally, users can opt to take advantage of the <code>CoordinateCleaner</code> package functions to exclude records flagged as containing potentially anomalous co-ordinates, based on a wider variety of spatial tests than <em>dynamicSDM</em> alone offers.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">sample_occ_filtered &lt;-<span class="st"> </span><span class="kw">spatiotemp_check</span>(<span class="dt">occ.data =</span> sample_occ,</a>
<a class="sourceLine" id="cb9-2" title="2">                                        <span class="dt">na.handle =</span> <span class="st">&quot;exclude&quot;</span>,</a>
<a class="sourceLine" id="cb9-3" title="3">                                        <span class="dt">date.handle =</span> <span class="st">&quot;exclude&quot;</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">                                        <span class="dt">date.res =</span> <span class="st">&quot;day&quot;</span>,</a>
<a class="sourceLine" id="cb9-5" title="5">                                        <span class="dt">coord.handle =</span> <span class="st">&quot;exclude&quot;</span>,</a>
<a class="sourceLine" id="cb9-6" title="6">                                        <span class="dt">duplicate.handle =</span> <span class="st">&quot;exclude&quot;</span>,</a>
<a class="sourceLine" id="cb9-7" title="7">                                        <span class="dt">coordclean =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb9-8" title="8">                                        <span class="dt">coordclean.species =</span> <span class="st">&quot;quelea&quot;</span>,</a>
<a class="sourceLine" id="cb9-9" title="9">                                        <span class="dt">coordclean.handle =</span> <span class="st">&quot;exclude&quot;</span>)</a></code></pre></div>
</div>
<div id="spatiotemporal-extent" class="section level4">
<h4>Spatiotemporal extent</h4>
<p>When generating dynamic species distribution models, it is important that occurrence records match the spatio-temporal extent of the study and any remote-sensing datasets to be utilised as explanatory variables. <code>spatiotemporal_extent()</code> removes any records outside of the set extents.</p>
<p>In this case study, we want to model the subspecies Q. q. lathamii which is typically limited to southern Africa and we will incorporate remote sensing datasets available for the years 2001 to 2019. To filter records to these extents, we use a polygon of southern African countries, which can be read into your R environment and applied using the following code.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">data</span>(<span class="st">&quot;sample_extent_data&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3">sample_occ_cropped &lt;-<span class="st"> </span><span class="kw">spatiotemp_extent</span>(<span class="dt">occ.data =</span> sample_occ_filtered,</a>
<a class="sourceLine" id="cb10-4" title="4">                                               <span class="dt">temporal.ext =</span> <span class="kw">c</span>(<span class="st">&quot;2001-01-01&quot;</span>, <span class="st">&quot;2018-12-01&quot;</span>),</a>
<a class="sourceLine" id="cb10-5" title="5">                                               <span class="dt">spatial.ext =</span> raster<span class="op">::</span><span class="kw">extent</span>(sample_extent_data),</a>
<a class="sourceLine" id="cb10-6" title="6">                                               <span class="dt">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>)</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; Loading required namespace: sf</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; spatial.ext could not be used as a mask.</span></a>
<a class="sourceLine" id="cb10-9" title="9"></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">## Lets plot the change</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="kw">plot</span>(sample_extent_data<span class="op">$</span>geometry)</a>
<a class="sourceLine" id="cb10-12" title="12"><span class="kw">plot</span>(<span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> sample_occ_filtered[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)], </a>
<a class="sourceLine" id="cb10-13" title="13">                            <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb10-14" title="14">                            <span class="dt">data =</span> sample_occ_filtered), <span class="dt">add =</span> T)</a></code></pre></div>
<p><img src="data:image/png;base64,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2s5QC/B2Zi4kc2wblRjtSqcrgLqM1MGtjLeAwkI1I9zR/dEcQKM6dwSQl5A8vKUnwqoA9gKyxzciwJsM0JePPsDembDbAnhP/3f4I+w8r9kFEF+A93hnjGbZP7nu9arq/4aA9aPoqtdrqv+bAt5T+8snBITsgR2vKNXKG0K11W36+/XDZfvfpuDmDaHmPcpa6elOYSG/+OXyilAzA3aQfdupT8RLAk4WdwrVHJbXFCfiLRHvlR6K9SwBk0lWHErbX8eboj76Hglg5J1FeWfUH0ICwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADASAEYCwEgAGAkAIwFgJACMBICRADD/AffoMP2iVn5vAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">plot</span>(sample_extent_data<span class="op">$</span>geometry)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">plot</span>(<span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> sample_occ_cropped[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)], </a>
<a class="sourceLine" id="cb11-4" title="4">                            <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb11-5" title="5">                            <span class="dt">data =</span> sample_occ_cropped), <span class="dt">add =</span> T)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="spatiotemporal-resolution" class="section level4">
<h4>Spatiotemporal resolution</h4>
<p>The spatial resolution of occurrence record co-ordinates and the temporal resolution of occurrence record dates are also important when generating dynamic SDMs. <code>spatiotemp_resolution()</code> can filter records by set thresholds.</p>
<p>As quelea migrations are driven by highly local and short-term environmental factors, we will filter to exclude records not given to the specific day and co-ordinates to four decimal places.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">sample_occ_cropped&lt;-<span class="kw">spatiotemp_resolution</span>(<span class="dt">occ.data =</span> sample_occ_cropped,</a>
<a class="sourceLine" id="cb12-2" title="2">                                             <span class="dt">spatial.res =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb12-3" title="3">                                             <span class="dt">temporal.res =</span> <span class="st">&quot;day&quot;</span>)</a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="kw">nrow</span>(sample_occ_cropped) <span class="co"># Even more records have been removed!</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt; [1] 142</span></a></code></pre></div>
</div>
</div>
<div id="c-test-for-spatial-and-temporal-sampling-biases" class="section level3">
<h3>c) Test for spatial and temporal sampling biases</h3>
<p>For many reasons, the collection of species occurrence records are biased through space and time. These biases can impact SDM performance by over- or under- representing conditions at a given site or time. <code>spatiotemp_bias()</code> returns the results of statistical tests and plots for visual assessment of such biases. The code below tests for bias across the entire dataset and species range.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">bias_results &lt;-<span class="st"> </span><span class="kw">spatiotemp_bias</span>(<span class="dt">occ.data =</span> sample_occ_cropped,</a>
<a class="sourceLine" id="cb13-2" title="2">                                <span class="dt">temporal.level =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>),</a>
<a class="sourceLine" id="cb13-3" title="3">                                <span class="dt">plot =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-4" title="4">                                <span class="dt">spatial.method =</span> <span class="st">&quot;simple&quot;</span>,</a>
<a class="sourceLine" id="cb13-5" title="5">                                <span class="dt">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb13-6" title="6">bias_results</a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">#&gt; $Temporal_bias_year</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">#&gt;  Chi-squared test for given probabilities</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">#&gt; data:  occ.data.frequency</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">#&gt; X-squared = 50.451, df = 15, p-value = 1.016e-05</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">#&gt; $Spatial_bias</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="co">#&gt;  Welch Two Sample t-test</span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="co">#&gt; data:  min.nndist.actual and min.nndist.random</span></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="co">#&gt; t = -6.42, df = 238.33, p-value = 7.304e-10</span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="co">#&gt;  -66172.72 -35097.89</span></a>
<a class="sourceLine" id="cb13-24" title="24"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb13-25" title="25"><span class="co">#&gt; mean of x mean of y </span></a>
<a class="sourceLine" id="cb13-26" title="26"><span class="co">#&gt;  45486.12  96121.42</span></a></code></pre></div>
<p>Whereas, this code will test for bias across only the core of the species range.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">bias_results &lt;-<span class="st"> </span><span class="kw">spatiotemp_bias</span>(<span class="dt">occ.data =</span> sample_occ_cropped,</a>
<a class="sourceLine" id="cb14-2" title="2">                                <span class="dt">temporal.level =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>),</a>
<a class="sourceLine" id="cb14-3" title="3">                                <span class="dt">plot =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">                                <span class="dt">spatial.method =</span> <span class="st">&quot;core&quot;</span>,</a>
<a class="sourceLine" id="cb14-5" title="5">                                <span class="dt">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb14-6" title="6">bias_results</a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">#&gt; $Temporal_bias_year</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="co">#&gt;  Chi-squared test for given probabilities</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="co">#&gt; data:  occ.data.frequency</span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co">#&gt; X-squared = 50.451, df = 15, p-value = 1.016e-05</span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co">#&gt; $Spatial_bias</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">#&gt;  Welch Two Sample t-test</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="co">#&gt; data:  min.nndist.actual and min.nndist.random</span></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="co">#&gt; t = -3.7412, df = 143.71, p-value = 0.0002639</span></a>
<a class="sourceLine" id="cb14-21" title="21"><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></a>
<a class="sourceLine" id="cb14-22" title="22"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb14-23" title="23"><span class="co">#&gt;  -24025.218  -7414.626</span></a>
<a class="sourceLine" id="cb14-24" title="24"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="co">#&gt; mean of x mean of y </span></a>
<a class="sourceLine" id="cb14-26" title="26"><span class="co">#&gt;  29862.97  45582.89</span></a></code></pre></div>
<p>Both approaches can generate important results. The latter may be a more reliable indicator if the species range is expanding or shifting in response to global change. This is because records at the range periphery that have been collected randomly may still not be evenly distributed through space and time due to underlying ecological processes. Therefore, testing for biases on the species range core may be more representative of true spatial and temporal sampling biases.</p>
</div>
<div id="d-account-for-spatial-and-temporal-sampling-biases" class="section level3">
<h3>d) Account for spatial and temporal sampling biases</h3>
<div id="occurrence-record-thinning" class="section level4">
<h4>Occurrence record thinning</h4>
<p>One approach to correct spatio-temporal sampling biases are to “thin” records, which involves excluding records that have been collected too closely in space or time. <code>spatiotemp_thin()</code> allows users to specify the spatial and temporal distance to thin records by. An important argument of <code>spatiotemp_thin()</code> is <code>spatial.split.degrees</code> which specifies the size of grid cells to split occurrence records into before temporal thinning. This prevents spatially distant but temporally close records from being filtered out.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">occ_thin &lt;-<span class="st"> </span><span class="kw">spatiotemp_thin</span>(<span class="dt">occ.data =</span> sample_occ_cropped,</a>
<a class="sourceLine" id="cb15-2" title="2">                                   <span class="dt">temporal.method =</span> <span class="st">&quot;day&quot;</span>,</a>
<a class="sourceLine" id="cb15-3" title="3">                                   <span class="dt">temporal.dist =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb15-4" title="4">                                   <span class="dt">spatial.split.degrees =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb15-5" title="5">                                   <span class="dt">spatial.dist =</span> <span class="dv">30000</span>,</a>
<a class="sourceLine" id="cb15-6" title="6">                                   <span class="dt">iterations =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">#&gt; ********************************************** </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#&gt;  Beginning Spatial Thinning.</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt;  Script Started at: Fri Mar 17 06:11:00 2023</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#&gt; lat.long.thin.count</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">#&gt; 87 </span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 87&quot;</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">#&gt; ********************************************** </span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">#&gt;  Beginning Spatial Thinning.</span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">#&gt;  Script Started at: Fri Mar 17 06:11:01 2023</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">#&gt; lat.long.thin.count</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">#&gt; 87 </span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 87&quot;</span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">#&gt; ********************************************** </span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="co">#&gt;  Beginning Spatial Thinning.</span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="co">#&gt;  Script Started at: Fri Mar 17 06:11:02 2023</span></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="co">#&gt; lat.long.thin.count</span></a>
<a class="sourceLine" id="cb15-29" title="29"><span class="co">#&gt; 87 </span></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb15-31" title="31"><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 87&quot;</span></a>
<a class="sourceLine" id="cb15-32" title="32"><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></a>
<a class="sourceLine" id="cb15-33" title="33"><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="co">#&gt; ********************************************** </span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="co">#&gt;  Beginning Spatial Thinning.</span></a>
<a class="sourceLine" id="cb15-36" title="36"><span class="co">#&gt;  Script Started at: Fri Mar 17 06:11:02 2023</span></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="co">#&gt; lat.long.thin.count</span></a>
<a class="sourceLine" id="cb15-38" title="38"><span class="co">#&gt; 88 </span></a>
<a class="sourceLine" id="cb15-39" title="39"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb15-40" title="40"><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 88&quot;</span></a>
<a class="sourceLine" id="cb15-41" title="41"><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></a>
<a class="sourceLine" id="cb15-42" title="42"><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></a>
<a class="sourceLine" id="cb15-43" title="43"><span class="co">#&gt; ********************************************** </span></a>
<a class="sourceLine" id="cb15-44" title="44"><span class="co">#&gt;  Beginning Spatial Thinning.</span></a>
<a class="sourceLine" id="cb15-45" title="45"><span class="co">#&gt;  Script Started at: Fri Mar 17 06:11:03 2023</span></a>
<a class="sourceLine" id="cb15-46" title="46"><span class="co">#&gt; lat.long.thin.count</span></a>
<a class="sourceLine" id="cb15-47" title="47"><span class="co">#&gt; 87 </span></a>
<a class="sourceLine" id="cb15-48" title="48"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb15-49" title="49"><span class="co">#&gt; [1] &quot;Maximum number of records after thinning: 87&quot;</span></a>
<a class="sourceLine" id="cb15-50" title="50"><span class="co">#&gt; [1] &quot;Number of data.frames with max records: 1&quot;</span></a>
<a class="sourceLine" id="cb15-51" title="51"><span class="co">#&gt; [1] &quot;No files written for this run.&quot;</span></a>
<a class="sourceLine" id="cb15-52" title="52"></a>
<a class="sourceLine" id="cb15-53" title="53"><span class="co"># Plot the difference in spatial distribution after thinning</span></a>
<a class="sourceLine" id="cb15-54" title="54"><span class="co"># Non-thinned</span></a>
<a class="sourceLine" id="cb15-55" title="55"><span class="kw">plot</span>(sample_extent_data<span class="op">$</span>geometry)</a>
<a class="sourceLine" id="cb15-56" title="56">sp<span class="op">::</span><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> sample_occ_cropped[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</a>
<a class="sourceLine" id="cb15-57" title="57">                                    <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb15-58" title="58">                                    <span class="dt">data =</span> sample_occ_cropped), <span class="dt">add =</span> T)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co"># Thinned</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw">plot</span>(sample_extent_data<span class="op">$</span>geometry)</a>
<a class="sourceLine" id="cb16-4" title="4">sp<span class="op">::</span><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> occ_thin[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</a>
<a class="sourceLine" id="cb16-5" title="5">                                    <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb16-6" title="6">                                    <span class="dt">data =</span> occ_thin), <span class="dt">add =</span> T)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="weight-records-by-sampling-effort" class="section level4">
<h4>Weight records by sampling effort</h4>
<p>Another approach to account for spatio-temporal sampling biases is to weight records by sampling effort when fitting SDMs.This results in the downweighting of the importance of records from over-sampled regions and vice versa.</p>
<p>Here, we will read in a sample of e-Bird avian sampling records in southern Africa to use as a proxy for sampling effort, and sum these across a spatial and temporal buffer from each occurrence record using <code>spatiotemp_weights()</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">data</span>(<span class="st">&quot;sample_events_data&quot;</span>)</a>
<a class="sourceLine" id="cb17-2" title="2">sample_occ_cropped &lt;-<span class="st"> </span><span class="kw">spatiotemp_weights</span>(<span class="dt">occ.data =</span> sample_occ_cropped,</a>
<a class="sourceLine" id="cb17-3" title="3">                                       <span class="dt">samp.events =</span> sample_events_data,</a>
<a class="sourceLine" id="cb17-4" title="4">                                       <span class="dt">spatial.dist =</span> <span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb17-5" title="5">                                       <span class="dt">temporal.dist =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb17-6" title="6">                                       <span class="dt">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt; Records completed: 100</span></a></code></pre></div>
</div>
</div>
<div id="e-generate-pseudo-absences-through-space-and-time" class="section level3">
<h3>e) Generate pseudo-absences through space and time</h3>
<p>Often the paucity of species absence records necessitates the generation of pseudo-absences, which are inferred absences based upon presence records. When modelling a species distribution at high spatiotemporal resolution, it may be best to generate pseudo-absences within close spatial and temporal buffers of species occurrence. This is because model presence-absence comparisons are made at fine scales, instead of coarsely between biomes and seasons. Using <code>spatiotemp_pseudoabs()</code> you can specify the spatial and temporal buffer size or extents to randomly generate pseudo-absences within.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># Pseudo-absences generated within spatial and temporal buffer</span></a>
<a class="sourceLine" id="cb18-2" title="2">pseudo_abs_buff &lt;-<span class="st"> </span><span class="kw">spatiotemp_pseudoabs</span>(<span class="dt">occ.data =</span> sample_occ_cropped,</a>
<a class="sourceLine" id="cb18-3" title="3">                                        <span class="dt">spatial.method =</span> <span class="st">&quot;buffer&quot;</span>,</a>
<a class="sourceLine" id="cb18-4" title="4">                                        <span class="dt">temporal.method =</span> <span class="st">&quot;buffer&quot;</span>,</a>
<a class="sourceLine" id="cb18-5" title="5">                                        <span class="dt">spatial.ext =</span> sample_extent_data,</a>
<a class="sourceLine" id="cb18-6" title="6">                                        <span class="dt">spatial.buffer =</span> <span class="kw">c</span>(<span class="dv">250000</span>, <span class="dv">500000</span>),</a>
<a class="sourceLine" id="cb18-7" title="7">                                        <span class="dt">temporal.buffer =</span> <span class="kw">c</span>(<span class="dv">42</span>, <span class="dv">84</span>),</a>
<a class="sourceLine" id="cb18-8" title="8">                                        <span class="dt">n.pseudoabs =</span> <span class="kw">nrow</span>(sample_occ_cropped))</a>
<a class="sourceLine" id="cb18-9" title="9"></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co"># Pseudo-absences generated randomly across given spatial and temporal extent</span></a>
<a class="sourceLine" id="cb18-11" title="11">pseudo_abs_rand &lt;-<span class="st"> </span><span class="kw">spatiotemp_pseudoabs</span>(<span class="dt">occ.data =</span> sample_occ_cropped,</a>
<a class="sourceLine" id="cb18-12" title="12">                                        <span class="dt">spatial.method =</span> <span class="st">&quot;random&quot;</span>,</a>
<a class="sourceLine" id="cb18-13" title="13">                                        <span class="dt">temporal.method =</span> <span class="st">&quot;random&quot;</span>,  </a>
<a class="sourceLine" id="cb18-14" title="14">                                        <span class="dt">spatial.ext =</span> sample_extent_data,</a>
<a class="sourceLine" id="cb18-15" title="15">                                        <span class="dt">temporal.ext =</span> <span class="kw">c</span>(<span class="st">&quot;2002-01-01&quot;</span>, <span class="st">&quot;2019-12-01&quot;</span>),</a>
<a class="sourceLine" id="cb18-16" title="16">                                        <span class="dt">n.pseudoabs =</span> <span class="kw">nrow</span>(sample_occ_cropped))</a>
<a class="sourceLine" id="cb18-17" title="17"></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co"># Plot the spatial distribution of pseudo-absences (red) compared to occurrence records for:</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co"># Buffered</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="kw">plot</span>(sample_extent_data<span class="op">$</span>geometry)</a>
<a class="sourceLine" id="cb18-21" title="21">sp<span class="op">::</span><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> sample_occ_cropped[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</a>
<a class="sourceLine" id="cb18-22" title="22">                                    <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb18-23" title="23">                                    <span class="dt">data =</span> sample_occ_cropped), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">add =</span> T)</a>
<a class="sourceLine" id="cb18-24" title="24">sp<span class="op">::</span><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> pseudo_abs_buff[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</a>
<a class="sourceLine" id="cb18-25" title="25">                                    <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb18-26" title="26">                                    <span class="dt">data =</span> pseudo_abs_buff), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">add =</span> T)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co"># Random</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">plot</span>(sample_extent_data<span class="op">$</span>geometry)</a>
<a class="sourceLine" id="cb19-4" title="4">sp<span class="op">::</span><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> sample_occ_cropped[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</a>
<a class="sourceLine" id="cb19-5" title="5">                                    <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb19-6" title="6">                                    <span class="dt">data =</span> sample_occ_cropped), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">add =</span> T)</a>
<a class="sourceLine" id="cb19-7" title="7">sp<span class="op">::</span><span class="kw">plot</span>(sp<span class="op">::</span><span class="kw">SpatialPointsDataFrame</span>(<span class="dt">coords =</span> pseudo_abs_rand[, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)],</a>
<a class="sourceLine" id="cb19-8" title="8">                                    <span class="dt">proj4string =</span> sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>),</a>
<a class="sourceLine" id="cb19-9" title="9">                                    <span class="dt">data =</span> pseudo_abs_rand), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">add =</span> T)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then, the generated pseudo-absences need to be added to the occurrence record data frame by adding relevant columns and binding the rows together.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">pseudo_abs_buff<span class="op">$</span>decimalLatitude &lt;-<span class="st"> </span>pseudo_abs_buff<span class="op">$</span>y</a>
<a class="sourceLine" id="cb20-2" title="2">pseudo_abs_buff<span class="op">$</span>decimalLongitude &lt;-<span class="st"> </span>pseudo_abs_buff<span class="op">$</span>x</a>
<a class="sourceLine" id="cb20-3" title="3">pseudo_abs_buff<span class="op">$</span>occurrenceStatus &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;absent&quot;</span>, <span class="kw">nrow</span>(pseudo_abs_buff))</a>
<a class="sourceLine" id="cb20-4" title="4">pseudo_abs_buff<span class="op">$</span>source &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;dynamicSDM&quot;</span>, <span class="kw">nrow</span>(pseudo_abs_buff))</a>
<a class="sourceLine" id="cb20-5" title="5">pseudo_abs_buff&lt;-<span class="kw">spatiotemp_weights</span>(<span class="dt">occ.data =</span> pseudo_abs_buff,</a>
<a class="sourceLine" id="cb20-6" title="6">                                       <span class="dt">samp.events =</span> sample_events_data,</a>
<a class="sourceLine" id="cb20-7" title="7">                                       <span class="dt">spatial.dist =</span> <span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb20-8" title="8">                                       <span class="dt">temporal.dist =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb20-9" title="9">                                       <span class="dt">prj =</span> <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb20-10" title="10"></a>
<a class="sourceLine" id="cb20-11" title="11">complete.dataset &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">rbind</span>(sample_occ_cropped, pseudo_abs_buff))</a></code></pre></div>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>At the end of this vignette, we now have a complete data frame of filtered species occurrence and pseudo-absence records of appropriate spatio-temporal quality, extent and resolution. Let’s save this to our project directory for use in the next tutorial!</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">write.csv</span>(complete.dataset, <span class="dt">file =</span> <span class="kw">paste0</span>(project_directory, <span class="st">&quot;/filtered_quelea_occ.csv&quot;</span>))</a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
